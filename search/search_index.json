{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Vigilant Engine \u00b6 Vigilant Engine is the ESP-IDF framework for Aerobear ESP-based nodes. It provides a stable base for networked devices with OTA updates, multiple Wi-Fi modes, a web configuration surface, and a shared peripheral layer. What this documentation covers \u00b6 How to build and flash main and recovery firmware The repo layout and where to add new features Runtime capabilities such as OTA and network modes Peripheral support and integration patterns Quick links \u00b6 Get started: Getting Started Build and flash: Build & Flash Recovery and OTA: Recovery & OTA Flash helper reference: Flash Helper","title":"Home"},{"location":"#vigilant-engine","text":"Vigilant Engine is the ESP-IDF framework for Aerobear ESP-based nodes. It provides a stable base for networked devices with OTA updates, multiple Wi-Fi modes, a web configuration surface, and a shared peripheral layer.","title":"Vigilant Engine"},{"location":"#what-this-documentation-covers","text":"How to build and flash main and recovery firmware The repo layout and where to add new features Runtime capabilities such as OTA and network modes Peripheral support and integration patterns","title":"What this documentation covers"},{"location":"#quick-links","text":"Get started: Getting Started Build and flash: Build & Flash Recovery and OTA: Recovery & OTA Flash helper reference: Flash Helper","title":"Quick links"},{"location":"build-flash/","text":"Build & Flash \u00b6 Vigilant Engine uses a two-partition layout with a recovery firmware in factory and the main firmware in ota_0 . To avoid accidentally overwriting recovery, use flash.py instead of idf.py flash . Build main firmware \u00b6 idf.py build Build recovery firmware \u00b6 cd vigilant-engine-recovery idf.py build Flash main firmware (recommended) \u00b6 Windows: python .\\flash.py main --port COM7 Linux/macOS: python3 ./flash.py main --port /dev/ttyACM0 Flash recovery firmware \u00b6 Windows: python .\\flash.py recovery --port COM7 Linux/macOS: python3 ./flash.py recovery --port /dev/ttyACM0 Common options \u00b6 --port (required): Serial port for the device --baud (optional): Default is 921600 --no-build (optional): Skip build and only flash binaries. Useful when you use idf.py build and just want to flash","title":"Build & Flash"},{"location":"build-flash/#build-flash","text":"Vigilant Engine uses a two-partition layout with a recovery firmware in factory and the main firmware in ota_0 . To avoid accidentally overwriting recovery, use flash.py instead of idf.py flash .","title":"Build &amp; Flash"},{"location":"build-flash/#build-main-firmware","text":"idf.py build","title":"Build main firmware"},{"location":"build-flash/#build-recovery-firmware","text":"cd vigilant-engine-recovery idf.py build","title":"Build recovery firmware"},{"location":"build-flash/#flash-main-firmware-recommended","text":"Windows: python .\\flash.py main --port COM7 Linux/macOS: python3 ./flash.py main --port /dev/ttyACM0","title":"Flash main firmware (recommended)"},{"location":"build-flash/#flash-recovery-firmware","text":"Windows: python .\\flash.py recovery --port COM7 Linux/macOS: python3 ./flash.py recovery --port /dev/ttyACM0","title":"Flash recovery firmware"},{"location":"build-flash/#common-options","text":"--port (required): Serial port for the device --baud (optional): Default is 921600 --no-build (optional): Skip build and only flash binaries. Useful when you use idf.py build and just want to flash","title":"Common options"},{"location":"config/","text":"Configuration \u00b6 Vigilant-Engine can be configured depending on the node. Some settings are present in the Menuconfig, which are not changeable in runtime, and some are configured in runtime. Runtime settings \u00b6 Runtime settings are configured in the main file like this: VigilantConfig VgConfig = { .unique_component_name = \"Vigilant ESP Test\", .network_mode = NW_MODE_APSTA }; Available settings: \u00b6 unique_component_name , string \u00b6 The name of the esp node, must be unique. network_mode , enum \u00b6 The network mode of the esp node. Options: \u00b6 NW_MODE_APSTA AP and STA mode NW_MODE_AP AP mode NW_MODE_STA STA mode Menuconfig Settings \u00b6 VE_ENABLE_STATUS_LED , bool \u00b6 Enable Status LED, enable this option to use the status LED functionality in Vigilant Engine. The status LED provides visual feedback on the system's status and operations, and can optionally be used for visual output. default : 1 VE_STATUS_LED_GPIO , int \u00b6 The GPIO pin number for the status LED. default : 8 VE_STA_SSID , string \u00b6 The SSID of the WiFi network the Vigilant Engine should connect to. default : \"aerobear\" VE_STA_PASSWORD , string \u00b6 The password for the WiFi network the Vigilant Engine should connect to. default : \"aerobear\" VE_STA_RECONNECT_INTERVAL_MS , int \u00b6 The interval in milliseconds for attempting to reconnect to the WiFi network when the connection is lost in STA mode. default : 3000 VE_AP_SSID_PREFIX , string \u00b6 The prefix for the SSID of the WiFi Access Point (AP) mode of the Vigilant Engine. The full SSID will be generated by appending the device's MAC address to this prefix. default : \"aerobear-\" VE_AP_PASSWORD , string \u00b6 The password for the WiFi Access Point (AP) mode of the Vigilant Engine. default : \"aerobear\"","title":"Configuration"},{"location":"config/#configuration","text":"Vigilant-Engine can be configured depending on the node. Some settings are present in the Menuconfig, which are not changeable in runtime, and some are configured in runtime.","title":"Configuration"},{"location":"config/#runtime-settings","text":"Runtime settings are configured in the main file like this: VigilantConfig VgConfig = { .unique_component_name = \"Vigilant ESP Test\", .network_mode = NW_MODE_APSTA };","title":"Runtime settings"},{"location":"config/#available-settings","text":"","title":"Available settings:"},{"location":"config/#unique_component_name-string","text":"The name of the esp node, must be unique.","title":"unique_component_name, string"},{"location":"config/#network_mode-enum","text":"The network mode of the esp node.","title":"network_mode, enum"},{"location":"config/#options","text":"NW_MODE_APSTA AP and STA mode NW_MODE_AP AP mode NW_MODE_STA STA mode","title":"Options:"},{"location":"config/#menuconfig-settings","text":"","title":"Menuconfig Settings"},{"location":"config/#ve_enable_status_led-bool","text":"Enable Status LED, enable this option to use the status LED functionality in Vigilant Engine. The status LED provides visual feedback on the system's status and operations, and can optionally be used for visual output. default : 1","title":"VE_ENABLE_STATUS_LED, bool"},{"location":"config/#ve_status_led_gpio-int","text":"The GPIO pin number for the status LED. default : 8","title":"VE_STATUS_LED_GPIO, int"},{"location":"config/#ve_sta_ssid-string","text":"The SSID of the WiFi network the Vigilant Engine should connect to. default : \"aerobear\"","title":"VE_STA_SSID, string"},{"location":"config/#ve_sta_password-string","text":"The password for the WiFi network the Vigilant Engine should connect to. default : \"aerobear\"","title":"VE_STA_PASSWORD, string"},{"location":"config/#ve_sta_reconnect_interval_ms-int","text":"The interval in milliseconds for attempting to reconnect to the WiFi network when the connection is lost in STA mode. default : 3000","title":"VE_STA_RECONNECT_INTERVAL_MS, int"},{"location":"config/#ve_ap_ssid_prefix-string","text":"The prefix for the SSID of the WiFi Access Point (AP) mode of the Vigilant Engine. The full SSID will be generated by appending the device's MAC address to this prefix. default : \"aerobear-\"","title":"VE_AP_SSID_PREFIX, string"},{"location":"config/#ve_ap_password-string","text":"The password for the WiFi Access Point (AP) mode of the Vigilant Engine. default : \"aerobear\"","title":"VE_AP_PASSWORD, string"},{"location":"features/","text":"Firmware Features \u00b6 Vigilant Engine provides a common set of capabilities intended to be reused across Aerobear nodes. OTA updates \u00b6 HTTP/Web-based firmware updates Designed for safe, recoverable update flow Network modes \u00b6 AP : Device hosts its own access point STA : Device connects to an existing Wi-Fi network APSTA : Dual mode Web server \u00b6 Configuration and status pages OTA firmware upload endpoint Endpoint structure intended to be extended per project Debugging and logging \u00b6 Wireless logging over network (websocket, visible on the dashboard) Centralized logging API for modules Recovery app \u00b6 Boots when the main app boot-loops Provides the OTA functionality WebUI for intuitive flashing","title":"Firmware Features"},{"location":"features/#firmware-features","text":"Vigilant Engine provides a common set of capabilities intended to be reused across Aerobear nodes.","title":"Firmware Features"},{"location":"features/#ota-updates","text":"HTTP/Web-based firmware updates Designed for safe, recoverable update flow","title":"OTA updates"},{"location":"features/#network-modes","text":"AP : Device hosts its own access point STA : Device connects to an existing Wi-Fi network APSTA : Dual mode","title":"Network modes"},{"location":"features/#web-server","text":"Configuration and status pages OTA firmware upload endpoint Endpoint structure intended to be extended per project","title":"Web server"},{"location":"features/#debugging-and-logging","text":"Wireless logging over network (websocket, visible on the dashboard) Centralized logging API for modules","title":"Debugging and logging"},{"location":"features/#recovery-app","text":"Boots when the main app boot-loops Provides the OTA functionality WebUI for intuitive flashing","title":"Recovery app"},{"location":"flash-helper/","text":"Flash Helper ( flash.py ) \u00b6 This repository uses flash.py to avoid overwriting the recovery firmware when flashing. What it does \u00b6 Builds firmware (optional) Flashes the correct image into the correct partition using parttool.py Prevents accidental overwrite of the recovery image Targets \u00b6 Main firmware: build/vigilant-engine.bin -> ota_0 Recovery firmware: vigilant-engine-recovery/build/vigilant-engine-recovery.bin -> factory Usage \u00b6 Windows: python .\\flash.py main --port COM7 python .\\flash.py recovery --port COM7 Linux/macOS: python3 ./flash.py main --port /dev/ttyACM0 python3 ./flash.py recovery --port /dev/ttyACM0 Options \u00b6 --port (required): Serial port of the ESP device --baud (optional): Baud rate, default 921600 --no-build (optional): Skip build step and flash existing binaries","title":"Flash Helper"},{"location":"flash-helper/#flash-helper-flashpy","text":"This repository uses flash.py to avoid overwriting the recovery firmware when flashing.","title":"Flash Helper (flash.py)"},{"location":"flash-helper/#what-it-does","text":"Builds firmware (optional) Flashes the correct image into the correct partition using parttool.py Prevents accidental overwrite of the recovery image","title":"What it does"},{"location":"flash-helper/#targets","text":"Main firmware: build/vigilant-engine.bin -> ota_0 Recovery firmware: vigilant-engine-recovery/build/vigilant-engine-recovery.bin -> factory","title":"Targets"},{"location":"flash-helper/#usage","text":"Windows: python .\\flash.py main --port COM7 python .\\flash.py recovery --port COM7 Linux/macOS: python3 ./flash.py main --port /dev/ttyACM0 python3 ./flash.py recovery --port /dev/ttyACM0","title":"Usage"},{"location":"flash-helper/#options","text":"--port (required): Serial port of the ESP device --baud (optional): Baud rate, default 921600 --no-build (optional): Skip build step and flash existing binaries","title":"Options"},{"location":"getting-started/","text":"Getting Started \u00b6 This project is built on ESP-IDF (currently 5.5.2). Make sure your ESP-IDF environment is exported before building or flashing. Prerequisites \u00b6 ESP-IDF installed and exported in your shell Python available in your ESP-IDF environment ^ To avoid this just use esp-idf in vs-code NodeJS & NPM installed A compatible ESP target and a USB serial connection Environment setup \u00b6 Use the ESP-IDF terminal in VS Code or run the ESP-IDF export script in your shell. The tooling relies on IDF_PATH and standard ESP-IDF environment variables. First build (main firmware) \u00b6 From the repository root: idf.py build If you need to set a specific target or configuration, do so before building: idf.py set-target <target> idf.py menuconfig First build (recovery firmware) \u00b6 The recovery firmware lives in vigilant-engine-recovery . Build it from that directory: cd vigilant-engine-recovery idf.py build","title":"Getting Started"},{"location":"getting-started/#getting-started","text":"This project is built on ESP-IDF (currently 5.5.2). Make sure your ESP-IDF environment is exported before building or flashing.","title":"Getting Started"},{"location":"getting-started/#prerequisites","text":"ESP-IDF installed and exported in your shell Python available in your ESP-IDF environment ^ To avoid this just use esp-idf in vs-code NodeJS & NPM installed A compatible ESP target and a USB serial connection","title":"Prerequisites"},{"location":"getting-started/#environment-setup","text":"Use the ESP-IDF terminal in VS Code or run the ESP-IDF export script in your shell. The tooling relies on IDF_PATH and standard ESP-IDF environment variables.","title":"Environment setup"},{"location":"getting-started/#first-build-main-firmware","text":"From the repository root: idf.py build If you need to set a specific target or configuration, do so before building: idf.py set-target <target> idf.py menuconfig","title":"First build (main firmware)"},{"location":"getting-started/#first-build-recovery-firmware","text":"The recovery firmware lives in vigilant-engine-recovery . Build it from that directory: cd vigilant-engine-recovery idf.py build","title":"First build (recovery firmware)"},{"location":"partitions/","text":"Partition Table \u00b6 The project uses a custom partition layout defined in partitions.csv . Primary partitions \u00b6 factory : Recovery firmware (1 MB at 0x10000 ) ota_0 : Main firmware (~2.94 MB at 0x110000 ) otadata : OTA selection data The factory partition is intended as a stable fallback and should not be overwritten during normal development.","title":"Partition Table"},{"location":"partitions/#partition-table","text":"The project uses a custom partition layout defined in partitions.csv .","title":"Partition Table"},{"location":"partitions/#primary-partitions","text":"factory : Recovery firmware (1 MB at 0x10000 ) ota_0 : Main firmware (~2.94 MB at 0x110000 ) otadata : OTA selection data The factory partition is intended as a stable fallback and should not be overwritten during normal development.","title":"Primary partitions"},{"location":"peripherals/","text":"Peripherals \u00b6 Vigilant Engine includes drivers and integration for common peripherals used across Aerobear nodes. Supported peripherals \u00b6 WS2812B : Addressable RGB LEDs (status indication, effects) TCAN4550-Q1 : SPI CAN controller (NOT IMPLEMENTED!) TCAN332 : CAN transceiver (NOT IMPLEMENTED!) These peripherals are wrapped behind a common abstraction layer to simplify reuse across multiple firmware targets.","title":"Peripherals"},{"location":"peripherals/#peripherals","text":"Vigilant Engine includes drivers and integration for common peripherals used across Aerobear nodes.","title":"Peripherals"},{"location":"peripherals/#supported-peripherals","text":"WS2812B : Addressable RGB LEDs (status indication, effects) TCAN4550-Q1 : SPI CAN controller (NOT IMPLEMENTED!) TCAN332 : CAN transceiver (NOT IMPLEMENTED!) These peripherals are wrapped behind a common abstraction layer to simplify reuse across multiple firmware targets.","title":"Supported peripherals"},{"location":"project-layout/","text":"Project Layout \u00b6 This repository contains the main firmware, recovery firmware, shared components, and a frontend subproject. The key paths are: main/ : Main firmware application source components/ : Reusable components shared across firmware targets managed_components/ : ESP-IDF managed components vigilant-engine-recovery/ : Recovery firmware project vigilant-engine-frontend/ : Frontend project for VE and the Recovery app docs/ : MkDocs content sdkconfig and sdkconfig.defaults : Build configuration and defaults partitions.csv : Partition table for firmware layout flash.py : Safe flashing helper for main and recovery images Where to add new functionality \u00b6 Project-specific (NOT VE) features and application logic: main/ Features you need in vigilant-engine: components/vigilant_engine Hardware drivers and reusable logic: components/ Recovery flow or minimal boot image changes: vigilant-engine-recovery/","title":"Project Layout"},{"location":"project-layout/#project-layout","text":"This repository contains the main firmware, recovery firmware, shared components, and a frontend subproject. The key paths are: main/ : Main firmware application source components/ : Reusable components shared across firmware targets managed_components/ : ESP-IDF managed components vigilant-engine-recovery/ : Recovery firmware project vigilant-engine-frontend/ : Frontend project for VE and the Recovery app docs/ : MkDocs content sdkconfig and sdkconfig.defaults : Build configuration and defaults partitions.csv : Partition table for firmware layout flash.py : Safe flashing helper for main and recovery images","title":"Project Layout"},{"location":"project-layout/#where-to-add-new-functionality","text":"Project-specific (NOT VE) features and application logic: main/ Features you need in vigilant-engine: components/vigilant_engine Hardware drivers and reusable logic: components/ Recovery flow or minimal boot image changes: vigilant-engine-recovery/","title":"Where to add new functionality"},{"location":"recovery-ota/","text":"Recovery & OTA \u00b6 Vigilant Engine uses two primary app partitions: factory : Recovery firmware (stable fallback image, very limited size) ota_0 : Main firmware (day-to-day runtime) The recovery firmware is intended as a safe fallback and a way to perform OTA updates even if the main image is corrupted. OTA workflow overview \u00b6 Device boots into ota_0 under normal conditions. If an OTA update fails or the main firmware is corrupted, the device can fall back to factory . The recovery firmware provides a path to re-flash the main image safely. Switching partitions manually \u00b6 You can manually switch OTA slots using ESP-IDF tooling when needed: python $IDF_PATH/components/app_update/otatool.py --port /dev/ttyACM0 switch_ota_partition --slot 0 Adjust the slot number and serial port to match your device.","title":"Recovery & OTA"},{"location":"recovery-ota/#recovery-ota","text":"Vigilant Engine uses two primary app partitions: factory : Recovery firmware (stable fallback image, very limited size) ota_0 : Main firmware (day-to-day runtime) The recovery firmware is intended as a safe fallback and a way to perform OTA updates even if the main image is corrupted.","title":"Recovery &amp; OTA"},{"location":"recovery-ota/#ota-workflow-overview","text":"Device boots into ota_0 under normal conditions. If an OTA update fails or the main firmware is corrupted, the device can fall back to factory . The recovery firmware provides a path to re-flash the main image safely.","title":"OTA workflow overview"},{"location":"recovery-ota/#switching-partitions-manually","text":"You can manually switch OTA slots using ESP-IDF tooling when needed: python $IDF_PATH/components/app_update/otatool.py --port /dev/ttyACM0 switch_ota_partition --slot 0 Adjust the slot number and serial port to match your device.","title":"Switching partitions manually"},{"location":"troubleshooting/","text":"Troubleshooting \u00b6 IDF_PATH is not set \u00b6 You are not in an ESP-IDF exported shell. Windows: open ESP-IDF PowerShell Linux/macOS: source export.sh BIN not found \u00b6 Make sure your build succeeded and the binaries exist: build/vigilant-engine.bin vigilant-engine-recovery/build/vigilant-engine-recovery.bin Port or permission errors \u00b6 Close serial monitors (for example idf.py monitor ) before flashing Verify the serial port is correct Always booting into the wrong partition \u00b6 Use otatool.py to select the correct slot: python $IDF_PATH/components/app_update/otatool.py --port /dev/ttyACM0 switch_ota_partition --slot 0 Flash size mismatch \u00b6 flash.py runs idf.py reconfigure , which rebuilds sdkconfig from sdkconfig.defaults . Set the correct flash size in sdkconfig.defaults so rebuilds keep the proper values.","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"troubleshooting/#idf_path-is-not-set","text":"You are not in an ESP-IDF exported shell. Windows: open ESP-IDF PowerShell Linux/macOS: source export.sh","title":"IDF_PATH is not set"},{"location":"troubleshooting/#bin-not-found","text":"Make sure your build succeeded and the binaries exist: build/vigilant-engine.bin vigilant-engine-recovery/build/vigilant-engine-recovery.bin","title":"BIN not found"},{"location":"troubleshooting/#port-or-permission-errors","text":"Close serial monitors (for example idf.py monitor ) before flashing Verify the serial port is correct","title":"Port or permission errors"},{"location":"troubleshooting/#always-booting-into-the-wrong-partition","text":"Use otatool.py to select the correct slot: python $IDF_PATH/components/app_update/otatool.py --port /dev/ttyACM0 switch_ota_partition --slot 0","title":"Always booting into the wrong partition"},{"location":"troubleshooting/#flash-size-mismatch","text":"flash.py runs idf.py reconfigure , which rebuilds sdkconfig from sdkconfig.defaults . Set the correct flash size in sdkconfig.defaults so rebuilds keep the proper values.","title":"Flash size mismatch"}]}